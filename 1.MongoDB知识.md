## 1.MongoDB的命令行连接

```mongo
/*连接mongodb*/
D:\MongDB\bin> mongo --host=localhost --port=27017

/*查看是否连接成功*/
D:\MongDB\bin> mongo show dbs

/*创建/切换数据库*/
use studentTable

/*删除数据库*/
db.dropDatabase()

/*查看当前所在数据库*/
db
```

## 2.集合显示创建

注：集合就是表

```mysql
/*创建集合（表）*/
db.createCollection('studentTable')

/*查看集合（表）*/
show collections 或 db.getCollectionNames()

/*删除集合（表）*/
db.studentTable.drop()

```

## 3.文档的增删改查

```mysql
/*单个文档插入{必须是JSON格式}*/
db.langbai.insert({"articleid":"100000","content":"今天天气很好,阳光明媚"})

/*多个文档插入{必须是JSON格式}*/
db.langbai.insertMany([
	{"name":"浪白","content":"学习MongoDB....","Date":new Date()},
	{"name":"诗人","content":"李白亲杜甫","Date":new Date()}
])


/*删除整行数据*/
db.langbai.remove({name:"浪白"})

/*删除全部数据*/
db.langbai.remove({})

/*删除字段（列）内容*/
db.studentTable.updata({'名字':'张泽鸿'},{$unset:{'数学':1}})	// 找到张泽鸿的数学字段并删除字段内容



/*局部修改*/
db.langbai.update({name:"诗人"}，{$set:{name:"唐三"}})

/*覆盖修改（以前的内容会被新内容覆盖掉）*/
db.langbai.update({name:"诗人"}，{name:"唐三"})

/*增/改内容*/
db.studentTable.update({_id:"15"},{$set:{"数学":666}}) // 找到id为15的数学字段并修改内容为666

/*多行更新*/
db.studentTable.updateMany({name:{'成龙','刘德华'}},{$set:{ age:60,like:'演员' }})



/*批量查询文档内容*/
db.langbai.find()

/*单个查询文档内容*/
db.langbai.find({Name:"诗人"})

/*投影查询（查询指定字段）*/
db.langbai.find({Name:"诗人"},{Name:1,_id:0})

/*模糊查询（正则查询）*/
db.studentTable.find({
    '语文':{$regex:/67/ig}
})

```

## 4.文档的分页查询

```mysql
/*显示前两条数据*/
db.studentTable.find().limit(2)	 //limit(2)表示只显示两条数据

/*显示第二页数据*/
db.studentTable.find().limit(2).skip(2)	 //skip(2)表示跳过前两条数据

/*排序查询*/
db.studentTable.find({},{"名字":1}).sort({"班级排名":1})	// 1 表示升序 -1表示降序
```

## 5.node连接MongoDB

```sql
/*安装MongoDB包*/
 npm i g mongoose
 
 /*node连接数据库*/
const mongodb = require('mongoose');
const DB_USER = 'gnin';
const hostURL = `mongodb://localhost:27017/${DB_USER}`;
mongodb.connect(hostURL, { useNewUrlParser: true})
.then( e => {
  console.log(`连接${hostURL}数据库成功`)
})
.catch( err => {
  console.log(`${err}连接${hostURL}数据库失败`)
})

/*多文档插入*/
const mongodb = require('mongodb').MongoClient;
const host = 'mongodb://localhost:27017/';

 mongodb.connect(host, { useNewUrlParser: true, useUnifiedTopoloy: true }, (err, db) => {
  if (err) throw err;
  const dbo = db.db('数据库名');
  const myobj = [
    { name: '曹芬', type: '網紅', like:['短视频','跳舞'],age:20},
    { name: '成龙', type: '明星', like:['拍片','演员'],age:65},
    { name: '吴彦祖', type: '明星', like:['拍戏','演员'],age:60},
    { name: '刘德华', type: '明星', like:['拍戏','演员'],age:60}
  ]
  dbo.collection('集合名').insertMany(myobj, (err, res)=>{
    if(err) throw err;
    console.log('文档插入成功:'+res.insertedCount);
    db.close();
  })
})



/*在node的基本查询*/
const mongodb = require('mongodb').MongoClient;
const host = 'mongodb://localhost:27017/';

mongodb.connect(host, { useNewUrlParser: true, useUnifiedTopoloy: true }, (err, db) => {
  if (err) throw err;
  const dbo = db.db('chen');

  dbo.collection('lang').find({ type:{$regex:/明星/ig }}).toArray((err, res) => {
    if (err) throw err;
    console.log(res);
    db.close();
  })
})



/*复杂查询*/
const mongodb = require('mongodb').MongoClient;
const host = 'mongodb://localhost:27017/';

mongodb.connect(host, { useNewUrlParser: true, useUnifiedTopoloy: true }, (err, db) => {
  if (err) throw err;
  const dbo = db.db('chen');
                
  const Inquire = {name:{
    $in:['刘德华','成龙']
  }}
                
  dbo.collection('lang').find(Inquire).toArray((err, res) => {
    if (err) throw err;
    console.log(res);
    db.close();
  })
})



/*更新一行或多行数据*/
const mongodb = require('mongodb').MongoClient;
const host = 'mongodb://localhost:27017/';

mongodb.connect(host, { useNewUrlParser: true, useUnifiedTopoloy: true }, (err, db) => {
  if (err) throw err;
                
  const dbo = db.db('chen');
  const Inquire = {
    name: {
      $in: ['刘德华', '成龙']
    }
  }
  const data = { $set: { age: 55, like: 'null' } }
                
  dbo.collection('lang').updateMany(Inquire, data, (err, res) => {
    if (err) throw err;
    console.log('文档更新成功');
    db.close();
  })
})

```

##### 1.node连接mongodb

```mysql
const mongodb = require('mongoose')

const DB_USER = 'USER';

const hostURL = `mongodb://localhost:27017/${DB_USER}`;

const dbPromise = new Promise( (resolve, reject) => {
  mongodb.connect(hostURL, { useNewUrlParser: true})
  .then( data => {
    resolve()
    console.log(`连接${hostURL}数据库成功`)
  })
  .catch( err => {
    reject()
    console.log(`${err}连接${hostURL}数据库失败`)
  })
})

;(async()=>{
  await dbPromise
  // 此处操作数据库
  
  //连接表并定义字段
  const Users = mongodb.model("USER",{
    nk_name: String,
    email: String,
    password: String
  })
  
  const users = new Users({
    nk_name: "胡2歌",
    email: '1222@qq.com',
    password: "123456"
  })
  
  //添加数据
  users.save().then((result)=>{
    console.log(result)
  })
  console.log(1)
})()


```

##### 2.node连接mongodb

```mysql
const mongodb = require('mongoose')

const DB_USER = 'USER';

const hostURL = `mongodb://localhost:27017/${DB_USER}`;

mongodb.connect(hostURL, { useNewUrlParser: true})
  .then( data => {
    console.log(`连接${hostURL}数据库成功`)
    // 操作数据库
    //连接表并定义字段
    const Users = mongodb.model("USER",{
      nk_name:String,
      email:String,
      password:String
    })
    
    const users = new Users({
      nk_name:"胡2歌",
      email:'1222@qq.com',
      password:"123456"
    })
    
    //添加数据
    users.save().then((result)=>{
      console.log(result)
    })
  },err => {
    console.log(`${err}连接${hostURL}数据库失败`)
  })



```

##### 3.node连接mongodb

```mysql
const mongodb = require('mongoose')

const DB_USER = 'USER';

const hostURL = `mongodb://localhost:27017/${DB_USER}`;

mongodb.connect(hostURL, { useNewUrlParser: true})
.then( data => {
  console.log(`连接${hostURL}数据库成功`)
})
.catch( err => {
  console.log(`${err}连接${hostURL}数据库失败`)
})

;(async()=>{
  await mongodb
  //操作数据库
  //连接表并定义字段
  const Users = mongodb.model("USER",{
    nk_name:String,
    email:String,
    password:String
  })
  
  const users = new Users({
    nk_name:"胡2歌",
    email:'1222@qq.com',
    password:"123456"
  })
  
  //添加数据
  users.save().then((result)=>{
    console.log(result)
  })
  console.log(1)
})()


```

##### 4.node连接mongodb

```mysql
const mongodb = require('mongoose')

const DB_USER = 'USER';

const hostURL = `mongodb://localhost:27017/${DB_USER}`;

mongodb.connect(hostURL, { useNewUrlParser: true })
  .then(data => {
    console.log(`连接${hostURL}数据库成功`)
    //操作数据库
    //连接表并定义字段
    const Users = mongodb.model("USER", {
      nk_name: String,
      email: String,
      password: String
    })

    const users = new Users({
      nk_name: "胡2歌",
      email: '1222@qq.com',
      password: "123456"
    })

    //添加数据
    users.save().then((result) => {
      console.log(result)
    })
    console.log(1)
  })
  .catch(err => {
    console.log(`${err}连接${hostURL}数据库失败`)
  })

```

##### 5.node连接mongodb

```mysql
const mongodb = require('mongoose')

const DB_USER = 'USER';

const hostURL = `mongodb://localhost:27017/${DB_USER}`;

mongodb.connect(hostURL, { useNewUrlParser: true})
.then( data => {
  console.log(`连接${hostURL}数据库成功`)
})
.catch( err => {
  console.log(`${err}连接${hostURL}数据库失败`)
})

//连接表并定义字段
const Users = mongodb.model("USER",{
  nk_name:String,
  email:String,
  password:String
})

const users = new Users({
  nk_name:"胡2歌",
  email:'1222@qq.com',
  password:"123456"
})

//添加数据
users.save().then((result)=>{
  console.log(result)
})


```

##### 6.node操作mongodb

```mysql
const mongodb = require('mongoose');

const DB_USER = 'USER';

const DB_URL = `mongodb://localhost:27017/${DB_USER}`;

mongodb.connect(DB_URL, { useNewUrlParser: true})
.then( data => {
  console.log(`连接${DB_URL}数据库成功`)
})
.catch( err => {
  console.log(`${err}连接${DB_URL}数据库失败`)
});

// 业务逻辑
(async()=>{
  await mongodb;

  // 引入约束
  const Schema = mongodb.Schema
  // 创建约束对象
  const USER_OBJ = new Schema({
    nk_name:{
      type: String,
      required: true, //限制必填项
      unique: true //限制唯一的
    },
    email:{
      type: String,
      required: true,
      unique: true
    },
    password:{
      type: String,
      required: true,
      unique: true
    },
    Dates:{
      type: Date,
      default: Date.now()
    }
  })
  // 创建模型
  const USER_Model = mongodb.model(DB_USER,USER_OBJ)
  // 操作数据库（增删改查）
  USER_Model.create({
    nk_name:'李白1',
    email: 'asdda@qq.com',
    password: '111111'
  },(err,data) => {
    if(err){
      console.log('数据插入失败：',err)
    }else{
      console.log('数据插入成功：',data)
    }
  })
})()
```

##### 6.node操作mongodb

```mysql

const mongodb = require('mongoose');

const DB_USER = 'USER';

const DB_URL = `mongodb://localhost:27017/${DB_USER}`;

mongodb.connect(DB_URL, { useNewUrlParser: true})
.then( data => {
  console.log(`连接${DB_URL}数据库成功`)
})
.catch( err => {
  console.log(`${err}连接${DB_URL}数据库失败`)
});

// 业务逻辑
(async()=>{
  await mongodb;

  // 引入约束
  const Schema = mongodb.Schema
  // 创建约束对象
  const USER_OBJ = new Schema({
    nk_name:{
      type: String,
      required: true, //限制必填项
      unique: true //限制唯一的
    },
    email:{
      type: String,
      required: true,
      unique: true
    },
    password:{
      type: String,
      required: true,
      unique: true
    },
    Dates:{
      type: Date,
      default: Date.now()
    }
  })
  // 创建模型
  const USER_Model = mongodb.model(DB_USER,USER_OBJ)
  // 操作数据库（增删改查）
  const createResult = new USER_Model({
    nk_name:'李白1',
    email: 'asdda@qq.com',
    password: '111111'
  })
  createResult.save()
  .then(data => {
    console.log('插入数据成功：',data)
  }, err => {
    console.log(err)
  })
})()


```

##### 8.mongoose-CRUD操作

```mysql
//连接表并定义字段
const Users = mongoose.model("user",{
  name:String,
  age:String,
  sex:String
})

const DB_users = new Users({
name:"胡歌",
age:26,
sex:"男"
})

//添加数据
DB_users.save()
.then((result)=>{
	console.log(result)
})

//删除数据
Users.remove({"name":"胡歌"}).then((result)=>{
console.log(result)
})

//修改数据
Users.update({“name”:"胡歌"},{$set:{"name":"江疏影"}}).then((result)=>{
console.log(result)
})

//查询数据
Users.find().then((result)=>{
console.log(result)
})


-------------------
const mongodb = require('mongoose');
// 引入约束
const Schema = mongodb.Schema
// 创建约束对象
const USER_OBJ = new Schema({
    nk_name:{
      type: String,
      required: true, //限制必填项
      unique: true //限制唯一的
    },
    email:{
      type: String,
      required: true,
      unique: true
    },
    password:{
      type: String,
      required: true,
      unique: true
    },
    Dates:{
      type: Date,
      default: Date.now()
    }
  })
  // 创建模型
  const USER_Model = mongodb.model(DB_USER,USER_OBJ)
  // 操作数据库（增删改查）
  const createResult = new USER_Model({
    nk_name:'李四',
    email: 'assdda@qq.com',
    password: '132111'
  })
  createResult.save()
  .then(data => {
    console.log('数据插入成功：',data)
  }, err => {
    console.log(err)
  })
```

  